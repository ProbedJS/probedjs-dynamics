/**
 * Copyright 2021 Francois Chabot
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let t=()=>{};class e{constructor(t){this.t=[],this.i=t}get current(){return this.i}set(t){const e=this.i!==t;this.i=t,e&&this.notify()}toString(){return`${this.i}`}addListener(e){this.t.push(e),t((()=>{this.removeListener(e)}))}removeListener(t){this.t.splice(this.t.indexOf(t),1)}notify(){let t=this.t.length;for(;t--;)this.t[t](this.i)}}e.prototype.o=1;class s extends e{push(t){this.i.push(t),this.notify()}map(t){const e=e=>{const s=[],r=e.length;for(let n=0;n<r;++n)s.push(t(e[n],n,e));return s},r=new s(e(this.current));return this.addListener((t=>{r.i=e(t)})),r}}class r extends e{valueOf(){return this.i}}function n(t){return Array.isArray(t)?new s(t):new r(t)}function i(t){return null!==t&&"object"==typeof t&&!!t.o}exports.dynamic=n,exports.isDynamic=i,exports.listen=function(t,e){i(t)&&t.addListener(e)},exports.setContextualCleanupHandler=e=>{t=e},exports.transform=function(t,e){if(i(e)){const s=n(t(e.current));return e.addListener((e=>s.set(t(e)))),s}return t(e)},exports.valType=function(t){return i(t)?typeof t.current:typeof t};
